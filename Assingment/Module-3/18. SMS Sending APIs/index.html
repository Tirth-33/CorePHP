<!DOCTYPE html>
<html>
<head>
    <title>SMS Notification System</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, -apple-system, sans-serif; background: linear-gradient(135deg, #667eea, #764ba2); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .sms-panel { background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); overflow: hidden; margin-bottom: 20px; }
        .header { background: #25d366; color: white; padding: 30px; text-align: center; }
        .header h1 { margin-bottom: 10px; }
        .content { padding: 30px; }
        .demo-note { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-bottom: 25px; color: #856404; }
        .notification-types { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .notification-card { border: 2px solid #e9ecef; border-radius: 10px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s; }
        .notification-card:hover { border-color: #25d366; transform: translateY(-2px); }
        .notification-card.active { border-color: #25d366; background: #f8fff8; }
        .notification-icon { font-size: 48px; margin-bottom: 15px; }
        .notification-title { font-size: 18px; font-weight: bold; color: #333; margin-bottom: 10px; }
        .notification-desc { color: #666; font-size: 14px; }
        .form-section { background: #f8f9fa; padding: 25px; border-radius: 10px; margin-bottom: 20px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; color: #333; font-weight: 500; }
        .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; }
        .form-group textarea { height: 100px; resize: vertical; }
        .send-btn { width: 100%; padding: 15px; background: #25d366; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; margin-top: 10px; }
        .send-btn:hover { background: #20c55a; }
        .send-btn:disabled { background: #ccc; cursor: not-allowed; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; padding: 15px; border-radius: 8px; margin-top: 20px; display: none; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; padding: 15px; border-radius: 8px; margin-top: 20px; display: none; }
        .loading { text-align: center; padding: 20px; color: #666; display: none; }
        .sms-preview { background: #e8f5e8; border: 1px solid #c3e6cb; padding: 20px; border-radius: 8px; margin-top: 20px; }
        .sms-preview h4 { color: #155724; margin-bottom: 10px; }
        .sms-mockup { background: white; border-radius: 15px; padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); max-width: 300px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="sms-panel">
            <div class="header">
                <h1>üì± SMS Notification System</h1>
                <p>Send SMS notifications for important events using Twilio</p>
            </div>

            <div class="content">
                <div class="demo-note">
                    <strong>Demo Mode:</strong> This simulates SMS sending via Twilio. For real SMS, configure Twilio credentials in the backend.
                </div>

                <h3>Select Notification Type</h3>
                <div class="notification-types">
                    <div class="notification-card" onclick="selectNotification('order')">
                        <div class="notification-icon">üõí</div>
                        <div class="notification-title">Order Confirmation</div>
                        <div class="notification-desc">Send SMS when order is placed</div>
                    </div>

                    <div class="notification-card" onclick="selectNotification('payment')">
                        <div class="notification-icon">üí≥</div>
                        <div class="notification-title">Payment Success</div>
                        <div class="notification-desc">Notify payment completion</div>
                    </div>

                    <div class="notification-card" onclick="selectNotification('shipping')">
                        <div class="notification-icon">üöö</div>
                        <div class="notification-title">Shipping Update</div>
                        <div class="notification-desc">Track order delivery status</div>
                    </div>

                    <div class="notification-card" onclick="selectNotification('otp')">
                        <div class="notification-icon">üîê</div>
                        <div class="notification-title">OTP Verification</div>
                        <div class="notification-desc">Send security codes</div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>SMS Details</h3>
                    
                    <div class="form-group">
                        <label for="phoneNumber">Phone Number</label>
                        <input type="tel" id="phoneNumber" placeholder="+91 9876543210" required>
                    </div>

                    <div class="form-group">
                        <label for="messageType">Message Type</label>
                        <select id="messageType" onchange="updateMessage()">
                            <option value="order">Order Confirmation</option>
                            <option value="payment">Payment Success</option>
                            <option value="shipping">Shipping Update</option>
                            <option value="otp">OTP Verification</option>
                            <option value="custom">Custom Message</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="smsMessage">Message Content</label>
                        <textarea id="smsMessage" placeholder="Your SMS message here..." required></textarea>
                        <small style="color: #666;">Character count: <span id="charCount">0</span>/160</small>
                    </div>

                    <button class="send-btn" onclick="sendSMS()" id="sendBtn">Send SMS Notification</button>
                </div>

                <div id="loading" class="loading">
                    Sending SMS notification...
                </div>

                <div id="success" class="success"></div>
                <div id="error" class="error"></div>

                <div id="smsPreview" class="sms-preview" style="display: none;">
                    <h4>üì± SMS Preview</h4>
                    <div class="sms-mockup">
                        <strong>From:</strong> YourBusiness<br>
                        <strong>To:</strong> <span id="previewPhone"></span><br>
                        <strong>Message:</strong><br>
                        <div id="previewMessage" style="margin-top: 10px; padding: 10px; background: #f0f0f0; border-radius: 5px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // SMS templates
        const smsTemplates = {
            order: "Hi! Your order #ORDER123 has been confirmed. Total: ‚Çπ1,299. Expected delivery: 3-5 days. Track: bit.ly/track123",
            payment: "Payment successful! ‚Çπ1,299 received for order #ORDER123. Transaction ID: TXN456789. Thank you for your purchase!",
            shipping: "Your order #ORDER123 is out for delivery! Expected delivery today by 6 PM. Track: bit.ly/track123",
            otp: "Your OTP for verification is: 123456. Valid for 10 minutes. Do not share this code with anyone."
        };

        let selectedNotification = 'order';

        function selectNotification(type) {
            // Remove active class from all cards
            document.querySelectorAll('.notification-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Add active class to selected card
            event.target.closest('.notification-card').classList.add('active');
            
            selectedNotification = type;
            document.getElementById('messageType').value = type;
            updateMessage();
        }

        function updateMessage() {
            const messageType = document.getElementById('messageType').value;
            const messageTextarea = document.getElementById('smsMessage');
            
            if (messageType !== 'custom' && smsTemplates[messageType]) {
                messageTextarea.value = smsTemplates[messageType];
            } else if (messageType === 'custom') {
                messageTextarea.value = '';
            }
            
            updateCharCount();
        }

        function updateCharCount() {
            const message = document.getElementById('smsMessage').value;
            const charCount = message.length;
            document.getElementById('charCount').textContent = charCount;
            
            // Change color based on character limit
            const charCountElement = document.getElementById('charCount');
            if (charCount > 160) {
                charCountElement.style.color = '#dc3545';
            } else if (charCount > 140) {
                charCountElement.style.color = '#ffc107';
            } else {
                charCountElement.style.color = '#28a745';
            }
        }

        async function sendSMS() {
            const phoneNumber = document.getElementById('phoneNumber').value.trim();
            const message = document.getElementById('smsMessage').value.trim();
            
            if (!phoneNumber || !message) {
                showError('Please enter phone number and message');
                return;
            }
            
            if (!isValidPhoneNumber(phoneNumber)) {
                showError('Please enter a valid phone number (e.g., +91 9876543210)');
                return;
            }
            
            if (message.length > 160) {
                showError('Message is too long. Please keep it under 160 characters.');
                return;
            }

            showLoading(true);
            hideMessages();

            try {
                const response = await fetch('send_sms.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        phone: phoneNumber,
                        message: message,
                        type: document.getElementById('messageType').value
                    })
                });

                const result = await response.json();

                if (response.ok) {
                    showSuccess(`SMS sent successfully! Message ID: ${result.message_id}`);
                    showPreview(phoneNumber, message);
                } else {
                    showError(result.error || 'Failed to send SMS');
                }
            } catch (error) {
                showError('Network error. Please try again.');
            } finally {
                showLoading(false);
            }
        }

        function isValidPhoneNumber(phone) {
            // Basic phone number validation
            const phoneRegex = /^\+?[1-9]\d{1,14}$/;
            return phoneRegex.test(phone.replace(/\s+/g, ''));
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('success');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
        }

        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
            document.getElementById('sendBtn').disabled = show;
        }

        function hideMessages() {
            document.getElementById('success').style.display = 'none';
            document.getElementById('error').style.display = 'none';
            document.getElementById('smsPreview').style.display = 'none';
        }

        function showPreview(phone, message) {
            document.getElementById('previewPhone').textContent = phone;
            document.getElementById('previewMessage').textContent = message;
            document.getElementById('smsPreview').style.display = 'block';
        }

        // Initialize
        document.getElementById('smsMessage').addEventListener('input', updateCharCount);
        
        // Set default message on load
        window.onload = function() {
            updateMessage();
            // Select first notification card by default
            document.querySelector('.notification-card').classList.add('active');
        };
    </script>
</body>
</html>